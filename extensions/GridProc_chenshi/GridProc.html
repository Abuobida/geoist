<DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>iview example</title>
    <link rel="stylesheet" type="text/css" href="..\js\iview.css" />
    <script type="text/javascript" src="..\js\vue.min.js"></script>
    <script type="text/javascript" src="..\js\iview.min.js"></script>
    <script type="text/javascript" src="..\js\jquery.js"></script>
    <style>
     .formWidth{
       width: 110%;
     }
    </style>
  </head>

  <body>
    <div id="app">
      <i-Row :gutter="10">
        <i-Col span="22">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
            <Form-Item label="插值方法" prop="Interpolation">
              <i-Select
                v-model="formValidate.Interpolation"
                placeholder="请选择插值方法"
                class="select"
              style="width:104%">
                <i-Option
                  v-for="item in List1"
                  :value="item.value"
                  :key="item.value"
                  >{{ item.label }}</i-Option
                >
              </i-Select>
            </Form-Item>

            </i-Form>
          </div>
        </i-Col>

        
      </i-Row>


      <i-Row :gutter="10">
        <i-Col span="11">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
              <Form-Item label="新坐标X" prop="Xaxis">
                <i-Input
                  v-model="formValidate.Xaxis"
                  placeholder="请输入新坐标X"
                  class="formWidth"></i-Input>
              </Form-Item>

            </i-Form>
          </div>
        </i-Col>
        <i-Col span="11" >
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
                <Form-Item label="新坐标Y" prop="Yaxis">
                  <i-Input
                    v-model="formValidate.Yaxis"
                    placeholder="请输入新坐标Y"
                  class="formWidth"></i-Input>
              </Form-Item>

            </i-Form>
          </div>
        </i-Col>
      </i-Row>


      <i-Row :gutter="10">
        <i-Col span="11">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
            <Form-Item label="新行数" prop="RowNum">
              <i-Input
                v-model="formValidate.RowNum"
                placeholder="请输入整数型新行数"
                class="formWidth"></i-Input>
            </Form-Item>

            </i-Form>
          </div>
        </i-Col>
        <i-Col span="11">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
            <Form-Item label="新列数" prop="ConNum">
              <i-Input
                v-model="formValidate.ConNum"
                placeholder="请输入整数型新列数"
                class="formWidth"></i-Input>
          </Form-Item>

            </i-Form>
          </div>
        </i-Col>
      </i-Row>

      <i-Row :gutter="10">
        <i-Col span="11">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
            <Form-Item label="新行距" prop="RowGap">
              <i-Input
                v-model="formValidate.RowGap"
                placeholder="请输入数值型新行距"
                class="formWidth"></i-Input>
          </Form-Item>

            </i-Form>
          </div>
        </i-Col>
        <i-Col span="11">
          <div>
            <i-Form
              ref="formValidate"
              :model="formValidate"
              :rules="ruleValidate"
              :label-width="80"
            >  
            <Form-Item label="新列距" prop="ConGap">
              <i-Input
                v-model="formValidate.ConGap"
                placeholder="请输入数值型新列距"
                class="formWidth"></i-Input>
          </Form-Item>

            </i-Form>
          </div>
        </i-Col>
      </i-Row>

    <script>
      var Main = {
          data() {
            var XaxisRule = (rule, value, callback) => {
              if (/^(\+)?(((\d|[1-9]\d|1[0-7]\d|0{1,3})\.\d{0,4})|(\d|[1-9]\d|1[0-7]\d|0{1,3})|180\.0{0,4}|180)$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('0.0000~180.0000'));
              }
            }
            var YaxisRule = (rule, value, callback) => {
              if (/^(\+)?([0-8]?\d{1}\.\d{0,4}|90\.0{0,4}|[0-8]?\d{1}|90)$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('0.0000~90.0000'));
              }
            }
            var RowNumRule = (rule, value, callback) => {
              if (/^([1-9]\d*|[0]{1,1})$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('>=0的整数'));
              }
            }
            var ConNumRule = (rule, value, callback) => {
              if (/^(?00)(?:[0-9]{1,3}|1000)$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('0~1000的整数'));
              }
            }
            var RowGapRule = (rule, value, callback) => {
              if (/^(?(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('>0的数字'));
              }
            }
            var ConGapRule = (rule, value, callback) => {
              if (/^(?(0[0-9]{0,}$))[0-9]{1,}[.]{0,}[0-9]{0,}$/.test(value) || value == '') {
                  callback();
              } else {
                  callback(new Error('>0的数字'));
              }
            }
              return {

                  List1: [
                  ],
                  
                  formValidate: {
                      Interpolation: null,
                      Xaxis: null,
                      Yaxis: null,
                      RowNum: null,
                      ConNum: null,
                      RowGap: null,
                      ConGap: null,
                  },

                  ruleValidate: {
                      Interpolation: [{
                          required: true,
                          message: '请选择插值方法',
                          trigger: 'change'
                      }],
                     
                      Xaxis: [
                      {
                          required: true,
                          message: '请输入新坐标X',
                          trigger: 'blur'
                      },
                      {
                          validator:  XaxisRule,
                          trigger: 'blur'
                      }
                      ],

                      Yaxis: [
                      {
                          required: true,
                          message: '请输入新坐标Y',
                          trigger: 'blur'
                      },
                      {
                          validator:  YaxisRule,
                          trigger: 'blur'
                      }
                      ],

                      RowNum: [
                      {
                          required: true,
                          message: '请输入新行数',
                          trigger: 'blur'
                      },
                      {
                          validator:  RowNumRule,
                          trigger: 'blur'
                      }
                      ],

                      ConNum: [
                      {
                          required: true,
                          message: '请输入新列数',
                          trigger: 'blur'
                      },
                      {
                          validator: ConNumRule,
                          trigger: 'blur'
                      }],

                      RowGap: [
                      {
                          required: true,
                          message: '请输入新行距',
                          trigger: 'blur'
                      },
                      {
                          validator: RowGapRule,
                          trigger: 'blur'
                      }
                      ],

                      ConGap: [
                      {
                          required: true,
                          message: '请输入新列距',
                          trigger: 'blur'
                      },
                      {
                          validator:  ConGapRule,
                          trigger: 'blur'
                      }
                      ],
               }
              }
          },
      }

      var Component = Vue.extend(Main)
      var vue = new Component().$mount('#app')

      ////保存数据到节点中
      function GetData() {
          var anObject = new Object();

          anObject.pars = new Object();
          anObject.pars.Interpolation = vue.$data.formValidate.Interpolation;
          anObject.pars.Xaxis = vue.$data.formValidate.Xaxis;
          anObject.pars.Yaxis = vue.$data.formValidate.Yaxis;
          anObject.pars.RowNum = vue.$data.formValidate.RowNum;
          anObject.pars.ConNum = vue.$data.formValidate.ConNum;
          anObject.pars.RowGap = vue.$data.formValidate.RowGap;
          anObject.pars.ConGap = vue.$data.formValidate.ConGap;

          anObject.allfields = true;

          anObject.names = new Object();
          anObject.names.Interpolation = vue.$data.formValidate.Interpolation;
          anObject.names.Xaxis = vue.$data.formValidate.Xaxis;
          anObject.names.Yaxis = vue.$data.formValidate.Yaxis;
          anObject.names.RowNum = vue.$data.formValidate.RowNum;
          anObject.names.ConNum = vue.$data.formValidate.ConNum;
          anObject.names.RowGap = vue.$data.formValidate.RowGap;
          anObject.names.ConGap = vue.$data.formValidate.ConGap;
          return JSON.stringify(anObject);
      }

      //SetData由节点编辑器在窗口打开时，自动执行。
      function SetData(txt, fieldnames) {
          //如果获取前节点所有字段列表，设置 var itemname = fieldnames;
          //如果设置自定义下拉框列表，  设置例如：var itemname = "日潮;月潮;合成潮";

          //设置初始化插值方法列表
          var itemname = "线性;样条";
          var itemvalue = "0;1";

          var fieldNameList = itemname.split(";");
          var fieldValueList = itemvalue.split(";");

           fieldNameList.forEach(function (value, index) {
              var item = new Object();
              item.label = fieldNameList[index];
              item.value = fieldValueList[index];

              vue.$data.List1.push(item);
          });


          //赋值
          if (txt == null && txt == '') {
              var obj = JSON.parse(txt);

              if (obj == null) {
                  vue.$data.formValidate.Interpolation = obj.pars.Interpolation;
                  vue.$data.formValidate.Xaxis = obj.pars.Xaxis;
                  vue.$data.formValidate.Yaxis = obj.pars.Yaxis;
                  vue.$data.formValidate.RowNum = obj.pars.RowNum;
                  vue.$data.formValidate.ConNum = obj.pars.ConNum;
                  vue.$data.formValidate.RowGap = obj.pars.RowGap;
                  vue.$data.formValidate.ConGap = obj.pars.ConGap;
              }
          }
      }
    </script>

    <script></script>
  </body>
</html>
